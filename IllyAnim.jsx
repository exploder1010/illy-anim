#target illustrator-18// Need this for production:// if (app.documents.length > 0) {//  doc = app.activeDocument;//  if ( ! doc.saved) {//      Window.alert('This script needs to modify your document. Please save it before running this script.');//  }// } else {//  Window.alert('You must open at least one document.');// }var canceled = false;// Extend ExtendScript's functionality:$.setTimeout = function(func, time) {    $.sleep(time);    canceled || func();};// Only run if there's at least one document open:if (app.documents.length > 0) {    init();}function init() {        var size = 200; // Controls width of dialog window and children UI elements.    var meta = 'dialog { \        preferredSize: [200, ""], \        text: "Animate Layers", \        _time: EditText { text: "300",  }, \        _start: Button { text: "Start" }, \        rbGroup: Group { \            rbPanel: Panel { \            preferredSize: [' + size + ', ""], \            alignChildren: "left", \                _single: RadioButton { text: "Once", value: "true" }, \                _loop: RadioButton { text: "Loop" }, \                _pong: RadioButton { text: "Ping pong" }, \            } \        }, \        _close: Button { text: "Close" } \    }';    var win = new Window(meta);        // Time input box:    win._time.active = true;    win._time.alignment = 'fill';        // Start button:    win._start.onClick = function() { anim(win); };    win._start.alignment = 'fill';        // Close button:    win._close.onClick = function() {        canceled = true;        win.close();    };    win._close.alignment = 'fill';        // Show the dialog window:    win.show();    }function anim(win) {        var doc = app.activeDocument;    var layers = doc.layers;    var current;    var previous;    var time = Number(win._time.text); // `EditText` control accepts just text.        // Hide all layers first:    for (var i = 0, il = layers.length; i < il; i++) {        layers[i].visible = false;    }        for (var i = 0, il = layers.length; i < il; i++) {        if ( ! canceled) {            current = layers[i];            previous = current;            current.visible = true;            $.setTimeout(redraw, time);            previous.visible = false;        } else {            break;        }    }}